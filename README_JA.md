# Research Data Insight Generator

**CSVデータを美しいAI分析チャートに変換するフルスタックアプリケーション**

![Data Insight Generator](./screenshot.png)

**ライブデモ:** [https://datainsight-n7dcbp6y.manus.space](https://datainsight-n7dcbp6y.manus.space)

---

## 概要

Research Data Insight Generatorは、OpenAIの「csv-to-charts」アプリをベースに、Manusのフルスタック技術スタック（React 19 + Express 4 + tRPC 11 + Drizzle ORM）で再構築した、研究・執筆活動向けの高機能データ可視化ツールです。

ユーザーはCSVファイルをアップロードするだけで、AIが自動的にデータを分析し、最適なチャートタイプと色スキームを推奨します。さらに、Manus LLM APIを活用した高度なデータ分析機能により、データセットの要約、主要な洞察の抽出、執筆時のアドバイスが自動生成されます。

このアプリケーションは、研究者、データアナリスト、学生、ビジネスプロフェッショナルなど、短時間で高品質なデータ可視化を必要とするすべてのユーザーを対象としています。

---

## 主な特徴

### 📊 データ可視化機能

**複数のチャートタイプ対応**  
棒グラフ、折れ線グラフ、円グラフ、ドーナツグラフなど、データの特性に応じた最適な可視化形式を選択できます。

**リアルタイムプレビュー**  
チャート設定を変更すると、即座にプレビュー画面に反映されます。色、背景、テキスト色などの細かなカスタマイズも可能です。

**柔軟なCSV解析**  
自動デリミタ検出（カンマ、セミコロン、タブ、パイプ）により、様々な形式のCSVファイルに対応します。ヘッダー行の自動認識により、複雑な設定は不要です。

**高品質エクスポート**  
生成したチャートはPNG形式でダウンロードでき、研究論文やプレゼンテーション資料に直接使用できます。

### 🤖 AI分析機能

**自動チャート最適化**  
「AI Optimize」ボタンをクリックするだけで、Manus LLMがデータセットを分析し、最適なチャートタイプと色パレットを推奨します。データ型の自動検出（数値、カテゴリ、日付）により、データの特性に応じた最適な推奨が可能です。

**データインサイト生成**  
「AI Insights」ボタンで、以下の内容が自動生成されます：
- **データ要約**: データセットの全体的な特徴を3～4文で説明
- **主要な洞察**: データから抽出された重要なパターンやトレンド
- **執筆アドバイス**: 研究論文やビジネス資料でこのデータについて書く際のアドバイス

### 🎨 デザイン・カスタマイズ機能

**複数の色パレット**  
Vibrant（鮮やか）、Pastel（淡色）、Professional（ビジネス向け）、Cool（冷色系）、Warm（暖色系）から選択できます。

**細かなカラーコントロール**  
基本色、キャンバス背景色、テキスト色をカラーピッカーで自由に調整できます。

**洗練されたダークテーム**  
研究や長時間の作業に適したダークテーマを採用。目の疲労を軽減しながら、プロフェッショナルな印象を保ちます。

**完全レスポンシブデザイン**  
デスクトップ、タブレット、スマートフォンなど、あらゆるデバイスで最適な表示を実現します。

---

## 技術スタック

### フロントエンド

**React 19** - 最新のReactフレームワークで、Suspenseなどの高度な機能に対応  
**Vite** - 高速なビルドツール。開発時のホットリロードにより、変更がリアルタイムで反映  
**TypeScript** - 型安全なJavaScript。開発時のエラー検出とコード補完を実現  
**Tailwind CSS 4** - ユーティリティファースト型のCSSフレームワーク。OKLCH色形式に対応  
**shadcn/ui** - アクセシビリティ重視の高品質UIコンポーネントライブラリ  
**Chart.js** - 複数のチャートタイプに対応した強力なチャートライブラリ  
**Lucide React** - 一貫性のある美しいアイコンセット

### バックエンド

**Express 4** - 軽量で柔軟なNode.js Webフレームワーク  
**tRPC 11** - エンドツーエンドの型安全なAPI。バックエンドで定義した型が自動的にフロントエンドに反映  
**Drizzle ORM** - 型安全なSQL クエリビルダー。複雑なクエリも簡潔に記述可能  
**Zod** - TypeScript ファーストなスキーマ検証ライブラリ

### AI・インフラストラクチャ

**Manus LLM API** - 高度な言語モデルによるデータ分析と洞察生成  
**Manus OAuth** - セキュアなユーザー認証システム  
**MySQL/TiDB** - 信頼性の高いリレーショナルデータベース  
**S3ストレージ** - クラウドベースのファイルストレージ

---

## システムアーキテクチャ

### 全体構成

```
┌─────────────────────────────────────────────────────────────┐
│                  フロントエンド (React 19)                   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │ DataVisualizer (メインコンポーネント)                │   │
│  │ ├─ DataControls (CSVアップロード・設定)              │   │
│  │ ├─ ChartCanvas (チャート描画)                        │   │
│  │ └─ AIInsights (AI分析パネル)                         │   │
│  └──────────────────────────────────────────────────────┘   │
│                          ↕ (tRPC)                            │
├─────────────────────────────────────────────────────────────┤
│              バックエンド (Express + tRPC)                   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │ tRPCルーター                                         │   │
│  │ ├─ ai.generateDataInsights (データ分析)             │   │
│  │ ├─ ai.optimizeChartStyle (チャート最適化)           │   │
│  │ ├─ ai.generateChartCaption (キャプション生成)       │   │
│  │ └─ auth.* (認証処理)                                │   │
│  └──────────────────────────────────────────────────────┘   │
│                          ↕                                    │
├─────────────────────────────────────────────────────────────┤
│                  外部サービス・データベース                  │
│  ├─ Manus LLM API (データ分析・洞察生成)                    │
│  ├─ Manus OAuth (ユーザー認証)                              │
│  ├─ MySQL データベース (データ永続化)                       │
│  └─ S3 ストレージ (ファイルストレージ)                      │
└─────────────────────────────────────────────────────────────┘
```

### データフロー

1. **CSVアップロード**: ユーザーがドラッグ&ドロップまたはファイル選択でCSVをアップロード
2. **解析**: フロントエンドがCSVを解析し、デリミタを自動検出
3. **設定**: ユーザーがチャートタイプ、列、スタイルを選択
4. **チャート生成**: Chart.jsがリアルタイムでチャートを描画
5. **AI最適化**: オプションで、AIがチャートタイプと色を推奨
6. **AI分析**: tRPCミューテーションがバックエンドのLLMを呼び出し
7. **エクスポート**: ユーザーがチャートをPNGでダウンロードまたはAI分析結果を表示

---

## 機能詳細

### CSVアップロード・解析

アプリケーションは以下のCSV処理機能を備えています：

**自動デリミタ検出**  
カンマ、セミコロン、タブ、パイプなど、複数のデリミタに対応。ユーザーは手動で指定することも可能です。

**ヘッダー行認識**  
最初の行を自動的にカラムヘッダーとして認識。複雑な設定は不要です。

**ドラッグ&ドロップ対応**  
ファイルをドラッグ&ドロップするだけでアップロード可能。直感的で使いやすいインターフェースです。

**サンプルデータ**  
デモ用のサンプルデータが事前ロードされているため、すぐにアプリケーションを試すことができます。

### チャートカスタマイズ

ユーザーはチャートの外観を細かく制御できます：

| 機能 | オプション | 説明 |
|------|----------|------|
| **チャートタイプ** | 棒グラフ、折れ線、円、ドーナツ | 複数の可視化形式から選択 |
| **ラベル列** | 任意の列 | X軸またはラベルに使用する列を指定 |
| **データ列** | 複数選択 | 表示するデータ列を選択 |
| **色パレット** | 5種類の定義済みパレット | プロフェッショナルな色の組み合わせ |
| **基本色** | カラーピッカー | チャート要素の主要色を調整 |
| **背景色** | カラーピッカー | チャートの背景色を設定 |
| **テキスト色** | カラーピッカー | ラベルと凡例のテキスト色を設定 |

### AI チャート最適化

**AI Optimize** 機能は、データセットを分析して以下を提供します：

**データ型検出**  
数値、カテゴリ、日付ベースのデータを自動識別

**チャートタイプ推奨**  
データの特性に基づいて、最適な可視化形式を提案

**色スキーム選択**  
プロフェッショナルな色パレットを推奨

**ワンクリック適用**  
推奨設定をクリック一つで自動適用

### AI データ分析

**AI Insights** 機能は以下を生成します：

**データ要約**  
データセットの構造と特徴の概要

**主要な洞察**  
自動抽出されたパターン、トレンド、異常値

**執筆アドバイス**  
研究論文やビジネス資料でこのデータについて書く際の指針

**プロフェッショナルなフォーマット**  
学術論文に適した構造化された出力

---

## インストール・セットアップ

### 前提条件

- Node.js 18以上とpnpmパッケージマネージャー
- MySQL 8.0以上またはTiDB互換データベース
- ManusプラットフォームアカウントとAPI認証情報

### ローカル開発環境

**1. リポジトリをクローン:**
```bash
git clone https://github.com/Tabibito-AI/research-data-insight-app.git
cd research-data-insight-app
```

**2. 依存パッケージをインストール:**
```bash
pnpm install
```

**3. 環境変数を設定:**
```bash
cp .env.example .env.local
```

`.env.local` ファイルを編集し、以下の環境変数を設定してください：

- `DATABASE_URL` - MySQL/TiDB接続文字列
- `JWT_SECRET` - セッション署名用秘密鍵
- `VITE_APP_ID` - Manus OAuth アプリケーションID
- `OAUTH_SERVER_URL` - Manus OAuth エンドポイント
- `VITE_OAUTH_PORTAL_URL` - Manusログインポータル
- `BUILT_IN_FORGE_API_URL` - Manus API エンドポイント
- `BUILT_IN_FORGE_API_KEY` - Manus API キー
- `VITE_APP_TITLE` - アプリケーションタイトル
- `VITE_APP_LOGO` - ロゴ画像URL

**4. データベースを初期化:**
```bash
pnpm db:push
```

**5. 開発サーバーを起動:**
```bash
pnpm dev
```

アプリケーションは `http://localhost:3000` で利用可能になります。

---

## Manusサーバーへのデプロイ

### 前提条件

- Manusプラットフォームアカウント
- GitHubリポジトリにこのコードがPush済み
- 個人アクセストークン

### デプロイ手順

**1. リポジトリを準備:**

すべてのファイルがコミットされ、GitHubにPushされていることを確認してください：

```bash
git add .
git commit -m "Initial commit: Research Data Insight Generator"
git push origin main
```

**2. Manusに接続:**

- Manusマネージメントダッシュボードにログイン
- 「新規プロジェクト作成」をクリック
- 「Webアプリテンプレート」を選択（データベースとユーザー機能付き）
- GitHubリポジトリを接続

**3. 環境を設定:**

- Manus Settings → Secrets で、すべての必須環境変数を設定
- データベース認証情報が正しく設定されていることを確認
- Manus LLMおよびOAuth サービスのAPI キーを確認

**4. デプロイを実行:**

- 開発環境でチェックポイントを作成
- マネージメントUIの「Publish」ボタンをクリック
- ビルドとデプロイの完了を待機
- 提供されたURLでライブアプリケーションにアクセス

**5. デプロイ後の確認:**

- CSVアップロード、チャート生成、AI分析などすべての機能をテスト
- ログを監視してエラーがないか確認
- 必要に応じてSettings → Domainsでカスタムドメインを設定

---

## プロジェクト構成

```
research-data-insight-app/
├── client/                          # フロントエンド React アプリケーション
│   ├── src/
│   │   ├── pages/
│   │   │   ├── Home.tsx            # ランディングページ
│   │   │   └── DataVisualizer.tsx  # メインアプリケーションインターフェース
│   │   ├── components/
│   │   │   ├── ChartCanvas.tsx     # チャート描画コンポーネント
│   │   │   ├── DataControls.tsx    # CSVアップロード・設定
│   │   │   └── AIInsights.tsx      # AI分析パネル表示
│   │   ├── lib/
│   │   │   └── trpc.ts             # tRPCクライアント設定
│   │   ├── App.tsx                 # メインアプリコンポーネント・ルーティング
│   │   ├── main.tsx                # エントリーポイント
│   │   └── index.css               # グローバルスタイル
│   ├── public/
│   │   └── sample-data.csv         # デモ用サンプルデータセット
│   └── index.html                  # HTMLテンプレート
├── server/                          # バックエンド Express アプリケーション
│   ├── routers.ts                  # tRPCプロシージャ定義
│   ├── db.ts                       # データベースクエリヘルパー
│   ├── _core/
│   │   ├── llm.ts                  # Manus LLM統合
│   │   ├── index.ts                # Express サーバーセットアップ
│   │   └── ...                     # その他のコアモジュール
│   └── storage.ts                  # S3ストレージヘルパー
├── drizzle/
│   └── schema.ts                   # データベーススキーマ定義
├── shared/
│   └── const.ts                    # 共有定数
├── package.json                    # プロジェクト依存関係
├── tsconfig.json                   # TypeScript設定
├── vite.config.ts                  # Viteビルド設定
└── README.md                       # このファイル
```

---

## 開発ワークフロー

### 新機能の追加

**1. データベーススキーマを更新（必要に応じて）:**
- `drizzle/schema.ts` を編集
- `pnpm db:push` を実行してマイグレーションを適用

**2. バックエンドロジックを追加:**
- `server/routers.ts` にプロシージャを作成または拡張
- AI機能には `invokeLLM()` を使用
- Zodスキーマを使用して型付きレスポンスを返す

**3. フロントエンドコンポーネントを構築:**
- `client/src/components/` にコンポーネントを作成
- `trpc.*.useQuery()` または `trpc.*.useMutation()` でデータを取得
- Tailwind CSSと shadcn/ui でスタイリング

**4. テストと反復:**
- `pnpm dev` で開発サーバーを起動
- `http://localhost:3000` でブラウザテスト
- コンソールでエラーと警告を確認

### データベースマイグレーション

```bash
# スキーマ変更からマイグレーションを生成
pnpm db:generate

# 保留中のマイグレーションを適用
pnpm db:push

# マイグレーション履歴を表示
pnpm db:studio
```

---

## API リファレンス

### tRPCプロシージャ

#### `ai.generateDataInsights`
アップロードされたデータセットの包括的なAI分析を生成します。

**入力:**
```typescript
{
  headers: string[];           // カラム名
  rows: any[][];              // データ行
  chartType: string;          // 現在のチャートタイプ
  selectedColumns: number[];  // 選択されたカラムのインデックス
}
```

**出力:**
```typescript
{
  summary: string;            // 3～4文のデータ要約
  insights: string[];         // 主要な洞察の配列
  writingTips: string;        // データについて書く際のアドバイス
}
```

#### `ai.optimizeChartStyle`
データ分析に基づいて、最適なチャートタイプと色スキームを推奨します。

**入力:**
```typescript
{
  headers: string[];                    // カラム名
  rows: any[][];                       // データ行
  dataTypes: Record<string, string>;   // カラムのデータ型
}
```

**出力:**
```typescript
{
  chartType: "bar" | "line" | "pie" | "doughnut";
  colorScheme: "vibrant" | "pastel" | "professional" | "cool" | "warm";
  explanation: string;                 // 推奨理由
  colorPalette: string[];             // 5つの16進数カラーの配列
}
```

#### `ai.generateChartCaption`
学術的なスタイルの図表キャプションを生成します。

**入力:**
```typescript
{
  chartType: string;   // チャートタイプ
  title: string;       // チャートタイトル
  description: string; // チャート説明
}
```

**出力:**
```typescript
{
  caption: string;     // 生成されたキャプション
}
```

---

## パフォーマンス最適化

アプリケーションは以下のパフォーマンス最適化を実装しています：

**コード分割**  
遅延ロードされるコンポーネントにより、初期バンドルサイズを削減

**キャッシング**  
tRPCクエリはAPI呼び出しを最小化するため結果をキャッシュ

**楽観的更新**  
UIはリクエスト処理中に即座に更新

**画像最適化**  
Canvasを使用した効率的なチャート描画

**データベースインデックス**  
適切なインデックスによる最適化されたクエリ

---

## セキュリティ機能

✅ **Manus OAuth認証** - セキュアなユーザー認証  
✅ **tRPCによる型安全なAPI** - エンドツーエンドの型チェック  
✅ **Zodスキーマによる入力検証** - すべてのAPI入力を検証  
✅ **CSRF保護** - クロスサイトリクエストフォージェリ対策  
✅ **XSS防止** - React自動エスケープ  
✅ **セキュアな認証情報管理** - Manus Secretsで安全に管理  

---

## トラブルシューティング

### CSVアップロードが機能しない場合

- ファイルが有効なCSV形式であることを確認
- デリミタが正しく検出されていることを確認
- ファイルサイズが適切であることを確認（推奨: 10MB未満）

### チャートが表示されない場合

- ブラウザキャッシュをクリアしてリロード
- ブラウザコンソールでJavaScriptエラーを確認
- データに数値が含まれていることを確認

### AI機能が機能しない場合

- Manus API認証情報が正しく設定されていることを確認
- Manusサービスへのネットワーク接続を確認
- サーバーログでAPIエラーを確認

### データベース接続エラーの場合

- `DATABASE_URL` が正しく設定されていることを確認
- `pnpm db:studio` でデータベース接続をテスト
- データベースユーザーが適切な権限を持っていることを確認

---

## 貢献

貢献を歓迎します。以下のガイドラインに従ってください：

1. リポジトリをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを開く

---

## ライセンス

このプロジェクトはMITライセンスの下でオープンソースとして利用可能です。

---

## サポート・フィードバック

問題、機能リクエスト、フィードバックについては：
- GitHubでIssueを開く
- 開発チームに連絡
- Manusプラットフォームドキュメントを参照

---

## 謝辞

このアプリケーションはManusAIプラットフォームを使用して開発されました。Manusは以下を提供しています：

- 高度な言語モデルによるデータ分析
- セキュアなOAuth認証
- クラウドインフラストラクチャとデプロイメント
- データベースとストレージサービス

---

## バージョン履歴

| バージョン | 日付 | 変更内容 |
|----------|------|--------|
| 1.0.0 | 2024年11月16日 | 初回リリース（コア機能搭載） |

---

**最終更新:** 2024年11月16日  
**デプロイURL:** [https://datainsight-n7dcbp6y.manus.space](https://datainsight-n7dcbp6y.manus.space)  
**リポジトリ:** [https://github.com/Tabibito-AI/research-data-insight-app](https://github.com/Tabibito-AI/research-data-insight-app)
